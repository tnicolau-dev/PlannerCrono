<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tarefas</title>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <link rel="stylesheet" href="../../css/theme.css">
  <link rel="stylesheet" href="../../css/style.css">
</head>

<body>
  <div class="conteudo_form">
    <h1>Lista de subtarefas</h1>

    <div class="box">
      <div class="filter">
        <button class="button btn_default" onclick="document.getElementById('filter_fields').showModal()">
          <span class="material-symbols-outlined">filter_alt</span>
          Filtro
        </button>
        <button class="button btn_ok" onclick="document.getElementById('insert_fileds').showModal()">
          <span class="material-symbols-outlined">add</span>
          Nova subtarefa
        </button>
      </div>

      <span id="error_get" class="inactive">Nenhum dado encontrado!</span>
      <div id="tabela_result">
        <table id="dataTable">
          <thead>
            <tr>
              <th></th>
              <th></th>
              <th>Registro</th>
              <th>Subtarefa</th>
              <th>Status</th>
              <th>Projeto</th>
              <th>Tarefa</th>
              <th>Conclusão</th>
            </tr>
          </thead>
          <tbody id="grid"></tbody>
        </table>
      </div>
      <div class="pagination" id="pagination"></div>

      <dialog id="filter_fields">
        <div class="filter_ajust header_field">
          <h2>Filtro</h2>
          <button class="button btn_ok" onclick="closeModal('filter_fields')"><span
              class="material-symbols-outlined">close</span></button>
        </div>
        <div class="input_field">
          <select class="input select_filtro" name="projeto_nome"></select>
          <input type="text" value="" name="tarefa_titulo" placeholder="Nome da tarefa">
          <input type="text" value="" name="subtarefa_titulo" placeholder="Subtarefa">
          <select class="input" name="status_legivel">
            <option value="" selected>Selecione um status</option>
            <option value="Pendente">Pendente</option>
            <option value="Concluído">Concluído</option>
          </select>
          <select name="sort_id" id="sort_id">
            <option value="">Sem ordenação</option>
            <option value="asc">Mais antigo</option>
            <option value="desc">Mais recente</option>
          </select>
        </div>
        <div class="filter_ajust button_field">
          <button class="button btn_default" onclick="applyFilter('filter_fields', 'grid')"><span
              class="material-symbols-outlined">filter_alt</span>Aplicar</button>
          <button class="button btn_ok" onclick="clearFilter('filter_fields', 'grid')"><span
              class="material-symbols-outlined">filter_alt_off</span>Limpar</button>
        </div>
      </dialog>

      <dialog id="insert_fileds">
        <div class="filter_ajust header_field">
          <h2>Nova subtarefa</h2>
          <button class="button btn_ok" onclick="closeModal('insert_fileds')"><span
              class="material-symbols-outlined">close</span></button>
        </div>
        <div class="input_field">
          <select class="input ignore" name="id_projeto"  id="id_projeto" required></select>
          <select class="input" name="id_tarefa" required></select>
          <!--
          <input list="list1" class="input" name="id_tarefa" required>
          <datalist class="subtarefas_list" id="list1"></datalist>
          -->
          <textarea value="" name="subtarefa_titulo" placeholder="Subtarefa" required></textarea>
        </div>
        <div class="error">
          <span></span>
        </div>
        <div class="filter_ajust button_field">
          <button class="button btn_default" onclick="postData('insert_fileds', 'subtarefas')"><span
              class="material-symbols-outlined">save</span>Salvar</button>
          <button class="button btn_ok" onclick="closeModal('insert_fileds')">Cancelar</button>
        </div>
      </dialog>

      <dialog id="update_fileds">
        <div class="filter_ajust header_field">
          <h2>Editar subtarefa</h2>
          <button class="button btn_ok" onclick="closeModal('update_fileds')"><span
              class="material-symbols-outlined">close</span></button>
        </div>
        <div class="input_field">
          <input class="inp_readonly" type="text" value="" name="projeto_nome" readonly>
          <input class="inp_readonly" type="text" value="" name="tarefa_titulo" readonly>
          <textarea value="" name="subtarefa_titulo" placeholder="Subtarefa" required></textarea>
          <input type="hidden" value="" name="id">
        </div>
        <div class="error">
          <span></span>
        </div>
        <div class="filter_ajust button_field">
          <button class="button btn_default" onclick="putData('update_fileds', 'subtarefas')"><span
              class="material-symbols-outlined">save</span>Salvar</button>
          <button class="button btn_ok" onclick="closeModal('update_fileds')">Cancelar</button>
        </div>
      </dialog>

      <dialog id="delete_fileds">
        <div class="filter_ajust header_field">
          <h2>Tem certeza que deseja excluir essa subtarefa?</h2>
        </div>
        <div class="input_field">
          <input class="inp_readonly" type="text" value="" name="subtarefa_titulo" readonly>
          <input type="hidden" value="" name="id">
        </div>
        <div class="error">
          <span></span>
        </div>
        <div class="filter_ajust button_field">
          <button class="button btn_alert" onclick="deleteData('delete_fileds', 'subtarefas')"><span
              class="material-symbols-outlined">Delete</span>Excluir</button>
          <button class="button btn_ok" onclick="document.getElementById('delete_fileds').close()">Cancelar</button>
        </div>
      </dialog>

    </div>
  </div>
</body>

<script src="../../js/script.js"></script>
<script>
  getTable('subtarefas');
  getProjetosList();
</script>

</html>